min_time = dict()
logs_csv = os.listdir('./data/query_log/')
for i, log_name in enumerate(logs_csv):
    
    log_names.append(log_name)
    
    if i % 4 == 0 and i != 0:
        print('')
    print(log_name, end='\t')
  
    with open('./data/query_log/' + log_name, 'r') as log_file:
        for j, line in enumerate(log_file):
            data = line.rstrip().split(',')
            
            time = int(data[2])
            file_name = data[0]
            device_name = data[1]
            product_name = data[3]
            
            if log_name not in min_time:
                min_time[log_name] = time
            else:
                if min_time[log_name] > time:
                    min_time[log_name] = time
                    
with open('./data/min_time.pickle', 'wb') as pickle_out:
    pickle.dump(min_time, pickle_out, protocol=pickle.HIGHEST_PROTOCOL)