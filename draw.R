library(ggplot2)
library(reshape)

time_product_zero = read.table(file='./data/time_product_count_0.tsv', sep='\t',header=T, stringsAsFactors=F)
time_product_one = read.table(file='./data/time_product_count_1.tsv', sep='\t', header=T, stringsAsFactors=F)

total = colSums(time_product_one) + colSums(time_product_zero)

zero = t(apply(time_product_zero, 1, function(x) x/total))
one = t(apply(time_product_one, 1, function(x) x/total))
rownames(zero) = seq(1, 86400)
rownames(one) = seq(1, 86400)

zero_melt = melt(zero, na.rm=TRUE)
one_melt = melt(one, na.rm=TRUE)

zero_melt$X1 = factor(zero_melt$X1)

jpeg('test.jpeg', height=1000, width=1000, res=200)
ggplot(data=zero_melt, aes(X2, X1, fill=value)) +
       geom_tile(color="white") +
       scale_fill_gradient(low="#0091ff", high = "#f0650e", limit=c(0, 1), space = "Lab", name='probability') +
       theme(axis.text.x=element_text(angle=45, vjust=1, hjust=1)) +
       theme(axis.title.x=element_blank(), axis.title.y=element_blank()) +
       theme(panel.grid.major=element_line(colour='gainsboro'), 
             panel.border=element_blank(),
             panel.background=element_blank())
dev.off()
